---
// Theme Toggle Component
// ä½¿ç”¨ Tailwind CSS dark mode (class strategy)
---

<button id="theme-toggle" type="button" aria-label="åˆ‡æ›æ·±è‰²æ¨¡å¼">
	<slot>
		<!-- é è¨­åœ–ç¤ºï¼Œå¯é€é slot è‡ªè¨‚ -->
		<span class="dark:hidden">ğŸŒ™</span>
		<span class="hidden dark:inline">â˜€ï¸</span>
	</slot>
</button>

<script is:inline>
	const toggle = document.getElementById("theme-toggle");
	const html = document.documentElement;

	// åˆå§‹åŒ–ï¼šæª¢æŸ¥ localStorage æˆ–ç³»çµ±åå¥½
	function initTheme() {
		const stored = localStorage.getItem("theme");
		if (
			stored === "dark" ||
			(!stored && window.matchMedia("(prefers-color-scheme: dark)").matches)
		) {
			html.classList.add("dark");
		} else {
			html.classList.remove("dark");
		}
	}

	// åˆ‡æ›ä¸»é¡Œ
	function toggleTheme() {
		if (html.classList.contains("dark")) {
			html.classList.remove("dark");
			localStorage.setItem("theme", "light");
		} else {
			html.classList.add("dark");
			localStorage.setItem("theme", "dark");
		}
	}

	initTheme();
	toggle?.addEventListener("click", toggleTheme);
</script>
